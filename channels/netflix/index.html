<!DOCTYPE html>
<html>
	<head>
		<title></title>
	</head>
	<body>
		<script 
			type="text/javascript" 
			src="http://localhost:1618/aurora-play.js"
		></script>
		<script type="text/javascript">
			var netflixChild = {
				name: 'netflix',
				main: 'https://www.netflix.com',
				active: true
			};
			var player = {
				show: true,
				progress: {
					show: true,
					current: 0,
					limit: 100
				},
				left: ['pause', 'volume_up'],
				right: ['fullscreen']
			};

			auroraPlay.emit('addChild', netflixChild);
			
			auroraPlay.on('childChangeUrl', function(data) {
				if(data.name === netflixChild.name) {
					var url = data.url;
					
					if(/\/watch\/[0-9]+/.test(url)) {
						auroraPlay.emit('execJSChild', {
							name: netflixChild.name,
							script: 'var __interval = setInterval(function() { var player = document.querySelector(".player-controls-wrapper"); if(player) { player.parentNode.removeChild(player); clearInterval(__interval); } console.log("interval"); }, 500);',
							afterLoad: true
						});
						
						auroraPlay.emit('player', player);
					}
				}
			});

			auroraPlay.on('playerPlay', function(state) {
				if(state) {
					player.left[0] = 'pause';
					auroraPlay.emit('player', player);
					auroraPlay.emit('execJSChild', {
						name: netflixChild.name,
						script: 'document.querySelector("video").play();',
						afterLoad: true
					});
				} else {
					player.left[0] = 'play_arrow';
					auroraPlay.emit('player', player);
					auroraPlay.emit('execJSChild', {
						name: netflixChild.name,
						script: 'document.querySelector("video").pause();',
						afterLoad: true
					});
				}
			});
		</script>
	</body>
</html>